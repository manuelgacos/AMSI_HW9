library('KernSmooth')

v <- c(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.75992761767219e-10, 2.6898412386344717e-09, 0.0, 0.0, 7.05148273105749e-10, 0.0, 0.0, 2.15676076997795e-09, 7.86069154212754e-10, 1.0530158078836394e-08, 8.05010003102069e-10, 2.750184524558108e-09, 6.70825084370108e-09, 0.0, 7.831103543409768e-10, 3.3711879954267943e-09, 0.0, 1.3376082463878447e-08, 5.1371777942677e-09, 2.7137407876409725e-09, 5.488800525199622e-09, 2.3588215825043335e-09, 0.0, 2.297882772950288e-09, 4.0264418466051666e-09, 4.509577600231296e-09, 4.163419387026579e-09, 0.0, 4.119892427212335e-09, 6.3566565344785886e-09, 8.508320270550485e-09, 1.964633256079651e-08, 3.816146953994348e-09, 1.6158185900394528e-09, 1.7579219857566386e-08, 9.113046317565932e-09, 0.0, 4.693678778977528e-09, 4.117363783251449e-09, 5.547278192352678e-09, 2.7532935931162683e-09, 2.5676545334363254e-09, 4.069465209255441e-09, 1.1604386340735573e-09, 1.1896278406808847e-09, 1.176486685849909e-09, 1.1991960757740117e-09, 1.7211456704302464e-09, 2.1776846992338506e-09, 5.247626777560299e-10, 0.0, 0.0, 2.3102715296374754e-09, 8.147825192317271e-10, 1.1145626643838114e-09, 2.369873186580662e-09, 0.0, 1.9535804085535347e-09, 1.735336985220215e-09, 1.927556558811716e-09, 7.308098570746324e-09, 7.218641240314128e-10, 1.4529188963052775e-09, 1.4018888272460117e-09, 2.822707845240302e-09, 2.0576063075594675e-09, 7.053182482508191e-10, 2.593494530245266e-09, 2.323692571692959e-09, 8.988535471488035e-10, 1.546565875365502e-09, 1.091439050249221e-09, 2.10411466028404e-09, 1.6525671941991504e-09, 1.6463121976784123e-09, 1.968059271106881e-09, 1.3374278351463431e-09, 1.0758712809533222e-09, 6.953358444583557e-10, 4.928406016624365e-10, 1.2826857354042431e-09, 9.224092600845779e-10, 1.453305253917847e-09, 2.1524351190294055e-09, 2.2081922956829203e-09, 1.503659197155116e-09, 2.795319975490429e-09, 3.2015656792339087e-09, 2.530552434265587e-09, 2.612969396409426e-09, 2.861999526260206e-09, 2.8343078994907955e-09, 2.2857795656250346e-09, 4.338205350506996e-09)
myts <- ts(v, start=1900, end=2000, frequency=1) 

Data <- data.frame(year=time(myts),  Y=as.matrix(myts))

model.l = loess(Y ~ year,
                data = Data,
                span = 0.75,        ### higher numbers for smoother fits
                degree=2,           ### use polynomials of order 2
                family="gaussian")  ### the default, use least squares to fit

summary(model.l)


smoothed <- predict(model.l)

plot(myts)

plot(x, y)
h <- dpill(x, y)
fit <- locpoly(x, y, bandwidth = h)
lines(fit)

#lines(smoothed, x=Data$year, col="red")

plotPredy(data  = Data,
          x     = year,
          y     = Y,
          model = model.l,
          xlab  = "Year",
          ylab  = "Words")
